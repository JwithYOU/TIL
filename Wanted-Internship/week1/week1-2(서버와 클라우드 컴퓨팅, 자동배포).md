# 원티드 프리온보딩 프론트엔드 인턴쉽 1주차

## Week1-2

### 1. 서버란?

우리는 흔히 인터넷으로 특정한 웹사이트나, 리소스에 접근합니다. 하지만 정확히 말하자면 우리가 접근하는 대상은 웹사이트, 리소스 자체가 아니라 해당 웹사이트와 리소스를 응답해주는 컴퓨터에 접속하는 것입니다.  
추상적으로 서비스가 운영되고 제공되는 과정을 알아보자면 서비스를 운영하기 위해서는 특정한 컴퓨터를 가동시킵니다. 그리고 해당 컴퓨터에서 특정 프로그램을 실행시켜서 컴퓨터에 네트워크를 통해 접근하면 특정한 리소스를 응답해주도록 만듭니다. 그리고 인터넷을 통해서 이 컴퓨터를 외부에서 접근 가능하도록 설정합니다. 이러한 동작을 하는 컴퓨터를 우리는 흔히 “서버"라고 부릅니다.

### 2. 서버를 운영하는 두가지 방법

#### 2-1 온프레미스(On-Premise)

온 프레미스는 서버를 운영하는측에서 서버에 필요한 물리적인 공간, 컴퓨터, 제반 시설등을 직접 구축해서 활용하는 방식을 의미합니다. 온 프레미스 방식은 직접 물리적인 서버를 구축하고 관리할 수 있는 전문 인력이 하드웨어를 구입해서 서버실을 구성하고 설계합니다.  
온 프레미스 방식은 서버 운영을 위해서 하나부터 열까지 관리해야하는 부분이 많기 때문에 많은 기업에서는 온 프레미스 방식보다는 클라우드 컴퓨팅 기반을 선호합니다.  
하지만 보안을 중요시 하는 환경에서는 온 프레미스 방식을 활용합니다.

#### 2-2. 클라우드 컴퓨팅(Cloud Computing)

클라우드 컴퓨팅은 컴퓨터를 인터넷을 이용한 클라우드 서비스를 통해서 사용하는 것을 의미합니다. 클라우드 컴퓨팅은 직접 물리적인 서버를 구매해서 관리할 필요 없이 클라우드 서비스 프로바이더를 원하는 사양을 원하는 시간만큼 대여해서 사용할 수 있습니다.  
클라우드 컴퓨팅을 사용자 입장에서는 물리적인 관리에 대한 필요성이 없고 필요한 사양을 원하는 시간만큼 대여해서 사용하기 때문에 비용 측면에서 효율적이며 컴퓨터의 사양이나 개수도 간단해서 서비스의 확장 측면에서도 이점이 있습니다.

### 3. 클라우드 컴퓨팅의 기본

클라우드 컴퓨팅은 제공하는 서비스의 수준에 따라서 3개의 계층으로 구분됩니다.

#### 3-1. IaaS(Infrastructure as a Service)

IaaS는 클라우드 컴퓨팅의 가장 기본적인 형태로서, 인프라를 구축하기 위해 컴퓨터를 대여해주는 것을 의미합니다. IaaS는 서비스를 구성하고 관리할 수 있으므로 가장 많은 제어권을 가지고 있지만 많은 부분을 일일이 구성하고 관리해줘야 한다는 단점이 있습니다.  
`AWS EC2`

#### 3-2. PaaS(Platform as a Service)

PaaS는 IaaS에 더불어 소프트웨어를 개발하고 운영하기 위해 필요한 구성요소들을 플랫폼화해서 제공해주는 서비스입니다. PaaS를 사용하면 소프트웨어의 운영에 대한 관리를 PaaS에 위임할 수 있기 때문에 효율적인 개발이 가능합니다. 다만, 플랫폼의 형태로 제공된다는 점 때문에 특정 플랫폼에 종속적이 될 수 있고, 해당 플랫폼에서 접근을 허용하지 않는 부분은 제어할 수 없다는 점, IaaS에 비해 더 높은 비용을 지불해야 할 수도 있다는 점 단점들도 있습니다.  
`AWS Elastic BeanStalk, Heroku, Github Pages`

#### 3-3. SaaS(Software as a Service)

SaaS는 클라우드 서비스에 더불어, 고객이 이를 사용할 수 있는 소프트웨어가 함께 제공되는 형태를 의미합니다. 클라우드 서비스를 통해서 제공받기에 애플리케이션을 PC에 설치할 필요가 없으며, 서비스를 활용하기 위해 만들어진 소프트웨어가 제공되기에 편리하게 활용할 수 있는 형태입니다.  
`DropBox, iCloud, Netflix, Google Apps, Slack`

### 4. AWS S3

AWS(Amazon Web Service)는 클라우드 컴퓨팅 서비스를 제공하는 프로바이더 중 하나로서, 가장 많이 사용되고 있는 클라우드 컴퓨팅 서비스입니다.

AWS의 S3서비스는 Simple Storage Service의 약자입니다. Storage라는 표현 그대로 파일을 저장하고 인터넷상으로 접근할 수 있게 해주는 서비스입니다. 정적인 파일들을 안정적으로 제공할 수 있다는 점을 이용해서 정적 웹사이트 호스팅에도 사용할 수 있습니다.

Create React App을 이용해서 만든 리액트 프로젝트의 경우 build 명령어를 실행하면 정적인 build 파일들이 생성되고 이를 브라우저에서 접근해서 실행하면 Client Side Rendering을 통해서 동작하는 특징을 이용해서 S3서비스를 통해서 배포를 할 수 있습니다.

버킷 정책
statement는 권할을 설정하는 코드  
Sid: 고유 id 같은거 유니크하게 작성하기만 하면 됨  
Effect: 두 가지 값이 들어가는 allow(접근 허용), deny(접근 X)  
Principal: 누가 접근 가능한지("\*" 이거는 누구나 접근 가능)
Action: 어떤 동작을 허용할건데
Resource: 어떤 리소스 인지[버킷 ARN(Amazon Resource Name)]

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::<bucket-name>/*"
    }
  ]
}
```

정리하자면 Resource 버킷 안에 파일들에서 getObject 하는거를 모두에게 허용한다

---

### CI/CD

CI/CD는 Continuous Integration(CI)와 Continuous Delivery/Deployment(CD)를 통합해서 부르는 용어입니다. CI/CD는 개발 과정에서 필요한 빌드, 테스트, 배포등의 과정을 자동화합니다. CI/CD 자동화를 통해서 효율적인 작업과, 더 빠르고 더 자주 배포를 진행할 수 있게 됩니다.

#### 1. CI

Continous Integration은 코드를 지속적으로 통합해나가는 것을 의미합니다. 일반적으로 코드의 통합은 GItHub의 PR을 통해서 진행할 수 있기에 CI 과정에서 도대체 무엇을 하는거지 의아할 수 있습니다. 여기서 말하는 코드의 통합은 단순히 코드와 코드를 합치는 것뿐만이 아니라 코드를 테스트하고 유효한지 검사하는 확인을 포함합니다. 코드를 통합할 때 가장 중요하고 걱정되는 부분은 “머지 후에 제대로 돌아갈까?”입니다. 이런 걱정과 의문을 매번 사람이 다 확인하는 것이 아니라 CI 과정에서 테스트를 실행하고 코드가 유효한지 검사하고 만약 문제가 발생했을 경우 즉각적으로 피드백을 통해서 개발자가 문제를 확인하고 수정할 수 있게 만들어줍니다.

#### 2. CD

Continuous Deployment는 CI 과정을 통해서 성공적으로 통합된 코드들을 실제 사용자가 사용하고 있는 Production 환경에 배포하는 것을 의미합니다. CD는 Continous Deployment와 Delivery 두 의미로 모두 사용되는데 Continuous Delivery는 개발환경의 배포까지 자동화 된 것을 의미하며, Continous Deployment는 실제 사용자에게 제공되는 Production 환경까지의 배포를 자동화 한 것을 의미합니다.

#### 3. CI / CD 플랫폼의 종류

CI/CD는 일련의 과정을 처리하는 CI/CD 파이프라인을 구축함으로서 자동화합니다. 개발자들은 이러한 파이프라인을 구축하고 모니터링 하기 위해서 이를 위한 CI/CD 플랫폼을 사용하는데 CI/CD 플랫폼의 종류를 구분하자면 크게 설치형과 클라우드형으로 나눌 수 있습니다.

CI/CD 파이프라인 또한 하나의 프로그램이므로 프로그램을 설계해두면 이를 실행할 컴퓨터가 필요합니다. 설치형은 파이프라인을 구축하는 개발자가 직접 특정 컴퓨터에 CI/CD 플랫폼을 설치해서 활용하는 방법입니다. 대표적인 설치형 CI/CD 플랫폼으로는 Jenkins가 있습니다.

반대로 클라우드형같은 경우에는 CI/CD 플랫폼을 운영할 컴퓨터를 개발자가 직접 관리할 필요 없이 서비스 제공자가 클라우드에서 모두 운영해주는 형태입니다. 즉 클라우드형 CI/CD 플랫폼을 이용하면 별도의 컴퓨팅 자원에 대한 관리 없이 CI/CD 파이프라인의 구축에만 신경 쓸 수 있습니다. 다만, 컴퓨터에 직접 접근할 수 없고 플랫폼에서 제공해주는 수준까지만 할 수 있기에 세부적인 조정이 불가능하다는 단점이 있습니다. 대표적인 클라우드형 CI/CD 플랫폼의 예시로는 Travis CI, GitHub Actions 등이 있습니다.

#### 4. CI/CD가 각광받는 이유

현재에는 어느정도 규모가 있는 개발팀의 경우에는 CI/CD를 구축하는 것이 보편적입니다. 사실 CI/CD는 장점만 있는 것은 아닙니다. CI/CD를 구축하고 운영하기 위해서는 이를 구축하고 관리하기 위한 노력도 필요하며, CI/CD 플랫폼, 서버를 사용해야하기에 개발자가 직접 배포 과정을 진행하는 것 보다 비용도 많이 든다는 단점이 있습니다. 이런 점에도 불구하고 왜 어느정도 규모가 있는 개발팀은 CI/CD를 구축하려고 할까요? 그 이유는 효율입니다.

소프트웨어는 하드웨어에 비해 상대적으로 변경하기가 쉽습니다. 그리고 기업에서는 항상 유저의 피드백을 통해서 프로덕트를 더 좋은 방향으로, 더 빨리, 더 자주 개선하고자 합니다. 이런 상황에서 개발자가 직접 수동으로 배포를 하는 과정에 리소스를 쏟기보다 프로덕트의 개발 및 개선 과정에 더 많은 리소스를 투입하는 것이 효율적이라고 판단하였습니다.

또한, 현재 IT업계에서 개발자의 몸값은 비쌉니다. 과거에는 하드웨어가 개발자의 몸값에 비해서 상대적으로 비쌌기에 하드웨어를 효율화하기 위해서 개발자들이 노력했다면 현대에는 기술의 발전으로 인해 하드웨어가 상대적으로 싸졌기에 비싼 인력인 개발자의 공수를 더 투입하는 것 보다 하드웨어의 사양을 증대시키거나, 필요한 PaaS 서비스들을 활용해서 개발자들이 핵심 가치를 창출하는 데 집중시키는 방향으로 산업이 발전하고 있습니다. CI/CD는 이러한 상황에 맞춰서 그 효율이 입증되어서 각광받고 있는 것입니다.

### GitHub Actions

GitHub Actions는 GitHub에서 제공하는 클라우드형 CI/CD 툴입니다. GitHub에서 자체적으로 제공하기에 GitHub 레파지토리와의 연동이 쉽고, 레파지토리 안에서 CI/CD까지 함께 구축하고 관리할 수 있다는 이점으로 인해 현재 많은 인기를 얻고 있습니다.

배포를 하고나서 수정을 하면? 다시 build 하고 배포 되어 있는거 삭제해서 다시 업로드 -> 매울 비효율적!

script로 배포하기 위한 과정(aws 예시)

1. aws cli 설치  
   [aws cli 설치 가이드 링크](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)

2. 배포계정에 접근하기 위해서는 로그인을 해야합니다

- 내 보안 자격 증명에서 액세스 키 만들기 클릭
- 설명 태그는 선택사항 -> 액세스 키 만들기 클릭
- 비밀 액세스 키 확인(해당 페이지를 벗어나면 다시 볼 수 없으므로 따로 저장)

3. 터미널에서 `aws configure --profile [원하는 이름]` 입력

4. 입력후에 Key ID, Access Key ID 입력하고 Default region name은 서울 기준으로 **ap-northeast-2** 입력 Default output format은 넘어가도 됩니다.

5. 터미널에 `aws s3 ls s3://[s3 버킷 이름] --profile [원하는 이름]` 입력하면 해당 s3에 접근이 가능합니다

6. `aws s3 sync build/ s3://[s3 버킷이름] --delete --profile [원하는 이름]`  
   이 내용을 입력하면 기존 배포 파일을 삭제하고 build 폴더 안에 있는 파일들을 올립니다.

여기까지는 반자동화된

### github action을 통한 자동 배포

1. .github/workflows/CICD.yml 을 추가한다.

2.

```yml
name: CI/CD

on:
  push:
    branches:
      - master
  workflow_dispatch:

jobs:
  cicd:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
      - run: npm ci
      - run: npm run test
      - run: npm run build
      - name: deploy to s3
        uses: jakejarvis/s3-sync-action@master
        with:
          args: --delete
        env:
          AWS_S3_BUCKET: ${{ secrets.AWS_S3_BUCKET }}
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          AWS_REGION: "ap-northeast-2"
          SOURCE_DIR: "build"
```

master branch에 push가 되면 배포가 되도록 설정합니다.  
깃허브 marcket place에서 다양한 action을 확인할 수 있습니다.
(이 양식은 sc로 검색했을때 star가 많은 걸로 선택했습니다.)  
env는 해당 .env파일을 올리는게 아닌 깃허브 레퍼지토리에서 설정할 수 있습니다.
